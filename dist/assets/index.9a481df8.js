var S=Object.defineProperty;var U=(s,e,u)=>e in s?S(s,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):s[e]=u;var n=(s,e,u)=>(U(s,typeof e!="symbol"?e+"":e,u),u);import{aV as v,aW as g,aX as E,aY as c,aU as w,aZ as f,b7 as x,b4 as L,a$ as y,E as O,a_ as I,b8 as N,b9 as M,ba as T,bb as F}from"./crypto.d6f76b55.js";import{r as C,u as V,a as h,F as H,j as o}from"./index.14b21fc8.js";var J=Object.defineProperty,W=Object.getOwnPropertyDescriptor,_=(s,e,u,l)=>{for(var r=l>1?void 0:l?W(e,u):e,p=s.length-1,d;p>=0;p--)(d=s[p])&&(r=(l?d(e,u,r):d(r))||r);return l&&r&&J(e,u,r),r};class i{constructor(){n(this,"resd",{});n(this,"captcha_base64","");n(this,"captcha_key","");n(this,"from_val",{});n(this,"Login",async(e={})=>{try{let u=await v.post(g.login_services,e);E(()=>{this.resd=u.data})}catch(u){c.info(`\u9519\u8BEF\u4FE1\u606F\uFF1A${u}`)}});n(this,"Captcha",async(e={})=>{try{let u=await v.post(g.captcha_services,e);E(()=>{this.captcha_base64=u.data.captcha_img,this.captcha_key=u.data.captcha_key})}catch(u){c.info(`\u9519\u8BEF\u4FE1\u606F\uFF1A${u}`)}})}}_([f],i.prototype,"resd",2);_([f],i.prototype,"captcha_base64",2);_([f],i.prototype,"captcha_key",2);_([f],i.prototype,"from_val",2);_([w.bound],i.prototype,"Login",2);_([w.bound],i.prototype,"Captcha",2);var a=new i;const X="_container_1cjsj_1",Y="_card_Con_1cjsj_12",Z="_submitbtn_1cjsj_16";var b={container:X,card_Con:Y,submitbtn:Z};function R(){const[s,e]=C.exports.useState(!1),[u,l]=C.exports.useState();C.exports.useEffect(()=>{},[]);const r=V(),p=()=>{r("/")};async function d(t){if(a.from_val=t,t.password=k(t),await a.Login(t),a.resd.key==="AU_0006"){c.error("\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165");return}if(a.resd.key==="AU_0011"){c.error("\u8FDE\u7EED5\u6B21\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF\uFF0C\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"),await a.Captcha(t),e(!0);return}a.resd.key==="S_0000"&&(B(a.resd.result.user_info),c.success(`\u767B\u5F55\u6210\u529F\uFF0C\u6B22\u8FCE\u60A8\u3010${a.resd.result.user_info.user_name}\u3011`),p()),console.log(a.from_val)}async function A(){e(!1),a.from_val.captcha_code=u,a.from_val.captcha_key=a.captcha_key;let t=a.from_val.account;if(await a.Login(a.from_val),a.resd.key==="AU_0011"){await a.Captcha(a.from_val),console.log("store.from_val",a.from_val),e(!0);return}if(a.resd.key==="AU_0009"&&c.error("\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01"),a.resd.key==="AU_0008"){c.error("\u9A8C\u8BC1\u7801\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01");let m={account:t};await a.Captcha(m),e(!0);return}a.resd.key==="S_0000"&&(B(a.resd.result.user_info),c.success(`\u767B\u5F55\u6210\u529F\uFF0C\u6B22\u8FCE\u60A8\u3010${a.resd.result.user_info.user_name}\u3011`),p())}function B(t){t=M(t),T(t,"gwm_userinfo")}function k(t){let m=t.account+"000000",j=t.password,$=F.enc.Utf8.parse(m),P=F.enc.Utf8.parse(j);return F.AES.encrypt(P,$,{mode:F.mode.ECB,padding:F.pad.Pkcs7}).toString()}function D(t){l(t)}return h(H,{children:[o(x,{children:o("div",{className:b.container,children:o(L,{className:b.card_Con,title:"\u767B\u5F55",children:h(y,{style:{width:350},onSubmit:d,children:[o(y.Input,{field:"account",label:"\u7528\u6237\u540D/\u5DE5\u53F7"}),o(y.Input,{mode:"password",field:"password",label:"\u5BC6\u7801"}),o(O,{className:b.submitbtn,htmlType:"submit",children:"\u63D0\u4EA4"})]})})})}),h(I,{title:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",visible:s,onOk:A,onCancel:t=>{t&&e(!1)},closeOnEsc:!0,children:[o(N,{onChange:D}),o("img",{src:`data:image/png;base64,${a.captcha_base64}`})]})]})}export{R as default};
